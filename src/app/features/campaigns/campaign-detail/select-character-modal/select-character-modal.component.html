<!-- Overlay qui couvre toute la page -->
<div (click)="close()" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 animate-fade-in"></div>

<!-- Conteneur de la modale -->
<div class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-800 p-8 rounded-lg shadow-2xl z-50 w-full max-w-md animate-scale-in">
  <!-- Bouton de fermeture -->
  <button (click)="close()" class="absolute top-3 right-3 text-gray-400 hover:text-white">&times;</button>

  <!-- Étape 1: Choix du type de personnage -->
  <div *ngIf="step === 'typeSelection'">
    <h3 class="text-2xl font-bold text-blue-300 mb-4">Choisir un type de personnage</h3>
    <p class="text-gray-400 mb-6">Quel type de personnage souhaitez-vous ajouter à la campagne ?</p>
    <div class="flex flex-col gap-4">
      <button (click)="selectCharacterType('ogl5')" class="w-full text-left p-4 bg-slate-700/50 hover:bg-purple-600/50 rounded-lg transition-colors">
        <span class="font-bold text-white">Personnage OGL 5</span>
        <span class="block text-sm text-gray-400">Utiliser un personnage basé sur les règles officielles.</span>
      </button>
      <button (click)="selectCharacterType('custom')" class="w-full text-left p-4 bg-slate-700/50 hover:bg-purple-600/50 rounded-lg transition-colors">
        <span class="font-bold text-white">Personnage Personnalisé</span>
        <span class="block text-sm text-gray-400">Utiliser un personnage avec des règles custom.</span>
      </button>
    </div>
  </div>

  <!-- Étape 2: Choix du personnage dans la liste -->
  <div *ngIf="step === 'characterSelection'">
    <h3 class="text-2xl font-bold text-blue-300 mb-4">Sélectionner votre personnage</h3>
    <div class="space-y-4">
      <!-- Liste déroulante pour OGL5 -->
      <select *ngIf="selectedType === 'ogl5'" (change)="onCharacterSelect($event)" class="w-full p-2 bg-slate-900/70 border border-slate-600 rounded-md text-gray-200">
        <option [value]="null" disabled selected>Choisir un personnage OGL 5...</option>
        <option *ngFor="let char of availableOglChars" [value]="char.id">{{ char.name }} (Niv. {{ char.level }})</option>
      </select>
      <!-- Liste déroulante pour Custom -->
      <select *ngIf="selectedType === 'custom'" (change)="onCharacterSelect($event)" class="w-full p-2 bg-slate-900/70 border border-slate-600 rounded-md text-gray-200">
        <option [value]="null" disabled selected>Choisir un personnage custom...</option>
        <option *ngFor="let char of availableCustomChars" [value]="char.id">{{ char.name }} (Niv. {{ char.level }})</option>
      </select>

      <button (click)="confirmSelection()" [disabled]="!selectedCharacterId || isAdding" class="w-full bg-purple-600 text-white font-bold py-2 rounded-lg hover:bg-purple-500 disabled:opacity-50">
        {{ isAdding ? 'Ajout en cours...' : 'Ajouter à la campagne' }}
      </button>
    </div>
  </div>
</div>
